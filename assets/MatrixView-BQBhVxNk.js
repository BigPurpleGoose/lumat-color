import{R as te,b as o,j as e,c as W,h as i,I as de,d as a,o as E,a1 as pe,a2 as he,G as xe,a3 as ge,ab as ue,ac as me,x as V}from"./vendor-ui-BT5Y1sOB.js";import{b as fe,g as ye,h as be}from"./opacityBlending-ClxNCCgU.js";import"./vendor-color-D1ETm4ty.js";import{A as je,u as O,g as Ce}from"./index-D-wgux2d.js";import{g as we,f as Se}from"./documentationExport-BxLMmq5H.js";import"./vendor-react-CpNYPCDL.js";function Ae(t,n){const h=Math.max(t,n),l=Math.min(t,n);return(h+.05)/(l+.05)}function ve(t,n){const{normBG:h,normTXT:l,revTXT:m,revBG:M,blkThrs:c,blkClmp:A,scaleBoW:v,scaleWoB:R,loConThresh:b,loConOffset:z,deltaYmin:F}=je;n=n>c?n:n+Math.pow(c-n,A),t=t>c?t:t+Math.pow(c-t,A);let d=0,x=0;return Math.abs(n-t)<F?0:(n>t?(d=(Math.pow(n,h)-Math.pow(t,l))*v,x=d<b?0:d-z):(d=(Math.pow(n,M)-Math.pow(t,m))*R,x=d>-b?0:d+z),x*100)}function ze(t,n){const h=Ae(t,n),l=ve(t,n);return{apca:Math.abs(l),wcag:h}}const se=te.memo(({lightness:t,opacity:n,hue:h,chroma:l,bgHex:m,bgLuminance:M,blendMode:c="srgb",isMatching:A=!1,targetLightness:v=50,contrastFilterEnabled:R=!1,contrastFilterType:b="wcag",contrastFilterThreshold:z=4.5,showHeatmap:F=!1,onHover:d,onLeave:x,onClick:P})=>{const p=o.useMemo(()=>fe(t,l,h,n,m,c),[t,l,h,n,m,c]),{wcagContrast:C,apcaContrast:f}=o.useMemo(()=>{const r=ze(p.luminance,M);return{wcagContrast:r.wcag,apcaContrast:r.apca}},[p.luminance,M]),D=A&&Math.abs(p.lightness-v)>3,H=(b==="wcag"?C:f)>=z,k=C>=7,G=C>=4.5,y=f>=90,g=f>=75,N=f>=60,u=(()=>{if(!F)return null;const B=(b==="apca"?f:C)/z;return B>=1.5?"rgba(34, 197, 94, 0.7)":B>=1?"rgba(59, 130, 246, 0.6)":B>=.8?"rgba(251, 191, 36, 0.6)":"rgba(239, 68, 68, 0.7)"})(),I=`oklch(${t}% ${l} ${h} / ${n}%)`,X=o.useCallback(r=>{requestAnimationFrame(()=>{d({x:r.clientX||0,y:r.clientY||0,content:e.jsxs("div",{style:{fontFamily:"monospace",fontSize:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Source:"}),e.jsxs("span",{style:{color:"#fafafa"},children:["L",t]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Opacity:"}),e.jsxs("span",{style:{color:"#fafafa"},children:[n,"%"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Result L*:"}),e.jsx("span",{style:{color:"#fafafa",fontWeight:"bold"},children:p.lightness.toFixed(1)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Hex:"}),e.jsx("span",{style:{color:"#fafafa",fontFamily:"monospace",fontSize:"10px"},children:p.hex})]}),e.jsxs("div",{style:{marginTop:"8px",borderTop:"1px solid #3f3f46",paddingTop:"8px"},children:[e.jsx("div",{style:{fontSize:"9px",textTransform:"uppercase",letterSpacing:"0.05em",color:"#71717a",marginBottom:"4px"},children:"Contrast"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"WCAG:"}),e.jsxs("span",{style:{color:"#fafafa",fontWeight:"bold"},children:[C.toFixed(2),":1",k&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#22c55e"},children:"AAA"}),!k&&G&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#3b82f6"},children:"AA"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"APCA:"}),e.jsxs("span",{style:{color:"#fafafa",fontWeight:"bold"},children:["Lc ",f.toFixed(0),y&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#facc15"},children:"GOLD"}),!y&&g&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#a1a1aa"},children:"SILVER"}),!y&&!g&&N&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#f97316"},children:"BRONZE"})]})]})]})]})})})},[t,n,p,C,f,k,G,y,g,N,d]),_=o.useCallback(()=>{P(I)},[I,P]);return e.jsx("div",{onClick:_,style:{position:"relative",aspectRatio:"1",backgroundColor:p.hex,borderRadius:"4px",cursor:"pointer",opacity:D?.25:R&&!H?.3:1,transition:"opacity 0.15s, transform 0.1s",border:"1px solid rgba(255, 255, 255, 0.05)"},onMouseEnter:r=>{const w=r.currentTarget;w.style.transform="scale(1.1)",w.style.zIndex="10",X(r)},onMouseLeave:r=>{const w=r.currentTarget;w.style.transform="scale(1)",w.style.zIndex="1",x()},children:u&&e.jsx("div",{style:{position:"absolute",inset:0,backgroundColor:u,borderRadius:"4px",pointerEvents:"none"}})})});se.displayName="MatrixCell";const Fe=({scale:t})=>{const n=O(s=>s.selectedBackground),h=O(s=>s.getLightnessSteps),l=O(s=>s.accessibilitySettings),m=O(s=>s.globalSettings.opacitySteps),M=O(s=>s.globalSettings.blendMode||"srgb"),[c,A]=o.useState({visible:!1,content:null,position:{x:0,y:0}}),[v,R]=o.useState(!1),[b,z]=o.useState(60),[F,d]=o.useState(!1),[x,P]=o.useState(!1),[p,C]=o.useState(!1),[f,D]=o.useState(!1),[T,H]=o.useState(1),[k,G]=o.useState(56),y=o.useRef(null),g=h(t),N=ye(be(n)),Z=o.useMemo(()=>g.map(s=>{const j=s/100;return Ce(j,t.manualChroma,t.hue,t.hueCurve,t.chromaCurve,{contrastMode:t.contrastMode||"standard",calculateContrast:!0,targetBackground:t.targetBackground||"black",targetLc:t.apcaTargetLc,targetWcagRatio:t.wcagTargetRatio,chromaCompensation:t.chromaCompensation??!0})}),[t,g]),u=o.useMemo(()=>we(Z,g),[Z,g]),I=o.useMemo(()=>{if(!l.enabled||!t.contrastThreshold?.enabled)return u;const s={minAPCA:t.contrastThreshold.useApca?t.contrastThreshold.minLc:void 0,minWCAG:t.contrastThreshold.useApca?void 0:t.contrastThreshold.minWcag,useAPCA:t.contrastThreshold.useApca??!0};return Se(u,s)},[u,t.contrastThreshold,l.enabled]),X=o.useCallback(s=>{A({visible:!0,content:s.content,position:{x:s.x,y:s.y}})},[]),_=o.useCallback(()=>{A({visible:!1,content:null,position:{x:0,y:0}})},[]),r=o.useMemo(()=>{const s=u.length,j=I.length,S=u.filter($=>$.apca>=75).length,L=u.filter($=>$.wcagLevel==="AAA").length;return{total:s,passing:j,passingPercent:(j/s*100).toFixed(1),apcaHighContrast:S,wcagAAA:L}},[u,I]),w=o.useCallback(s=>{navigator.clipboard.writeText(s),d(!0),setTimeout(()=>d(!1),2e3)},[]),B=o.useCallback(()=>{H(s=>Math.max(s-.25,.5))},[]),ne=o.useCallback(()=>{H(s=>Math.min(s+.25,2))},[]),oe=o.useCallback(()=>{H(1)},[]),U=l.enabled&&(t.contrastThreshold?.enabled||!1),q=t.contrastThreshold?.useApca?"apca":"wcag",K=q==="apca"?t.contrastThreshold?.minLc||60:t.contrastThreshold?.minWcag||4.5;return o.useEffect(()=>{const s=()=>{if(!y.current)return;const S=y.current,L=S.clientWidth,$=S.clientHeight,J=32,Q=4,Y=m.length,ee=g.length,ae=L-J-Q*(Y+2),re=$-J-60-Q*(ee+1),ie=Math.floor(ae/(Y+1)),le=Math.floor(re/ee),ce=Math.max(40,Math.min(ie,le,120));G(ce)};s();const j=new ResizeObserver(s);return y.current&&j.observe(y.current),()=>{j.disconnect()}},[m.length,g.length,x,p]),e.jsxs(W,{style:{position:"relative",width:"100%",display:"flex",flexDirection:"column",flex:1,minHeight:0,...x?{position:"fixed",inset:0,zIndex:50,backgroundColor:"#09090b"}:{}},children:[e.jsxs(i,{direction:"column",gap:"4",p:"4",style:{flex:1,minHeight:0,maxWidth:"100%",overflowY:"auto",paddingBottom:"80px"},children:[e.jsxs(i,{align:"center",justify:"between",gap:"3",style:{backgroundColor:"#18181b",borderRadius:"8px",padding:"10px 12px",border:"1px solid #3f3f46",flexWrap:"wrap"},children:[e.jsxs(i,{align:"center",gap:"2",style:{flex:"1",minWidth:"200px"},children:[e.jsx(de,{style:{width:"16px",height:"16px",color:"#6366f1",flexShrink:0}}),e.jsxs(a,{size:"1",color:"gray",children:[e.jsx(a,{as:"span",weight:"medium",style:{color:"#d4d4d8"},children:t.name})," ","at opacity levels on ",n]})]}),e.jsxs(i,{align:"center",gap:"3",style:{flexWrap:"wrap"},children:[e.jsxs(i,{align:"center",gap:"2",children:[e.jsx("input",{type:"checkbox",id:"match-mode",checked:v,onChange:s=>R(s.target.checked),style:{width:"16px",height:"16px",borderRadius:"4px",cursor:"pointer"}}),e.jsx(a,{as:"label",htmlFor:"match-mode",size:"1",weight:"medium",style:{cursor:"pointer",color:"#d4d4d8"},children:"Match"})]}),v&&e.jsxs(i,{align:"center",gap:"2",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:b,onChange:s=>z(Number(s.target.value)),style:{width:"96px"}}),e.jsxs(a,{size:"1",weight:"medium",style:{fontFamily:"monospace",width:"32px",color:"#d4d4d8"},children:["L",b]})]}),e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(a,{size:"1",weight:"medium",style:{color:"#a1a1aa"},children:"Zoom:"}),e.jsx(E,{size:"1",variant:"soft",onClick:B,disabled:T<=.5,children:"-"}),e.jsxs(a,{size:"1",weight:"bold",style:{fontFamily:"monospace",minWidth:"48px",textAlign:"center",color:"#d4d4d8"},children:[Math.round(T*100),"%"]}),e.jsx(E,{size:"1",variant:"soft",onClick:ne,disabled:T>=2,children:"+"}),e.jsx(E,{size:"1",variant:"outline",onClick:oe,disabled:T===1,children:"Reset"})]})]}),e.jsxs(pe,{children:[e.jsx(he,{children:e.jsxs(E,{size:"2",variant:"outline",children:[e.jsx(xe,{width:"16",height:"16"}),"Advanced"]})}),e.jsx(ge,{style:{width:"280px"},children:e.jsxs(i,{direction:"column",gap:"3",children:[e.jsx(a,{size:"2",weight:"bold",children:"Advanced Options"}),e.jsxs(E,{size:"2",variant:"soft",onClick:()=>C(!p),style:{width:"100%"},children:[p?"Hide":"Show"," Contrast Insights"]}),e.jsxs(i,{align:"center",gap:"2",children:[e.jsx("input",{type:"checkbox",id:"heatmap-mode",checked:f,onChange:s=>D(s.target.checked),style:{width:"16px",height:"16px",borderRadius:"4px",cursor:"pointer"}}),e.jsx(a,{as:"label",htmlFor:"heatmap-mode",size:"2",weight:"medium",style:{cursor:"pointer",color:"#d4d4d8"},children:"Heatmap Mode"})]}),U&&e.jsxs(W,{children:[e.jsx(a,{size:"1",weight:"medium",mb:"1",style:{color:"#a1a1aa"},children:"Active Filter"}),e.jsx(a,{size:"2",style:{color:"#d4d4d8",fontFamily:"monospace"},children:q==="apca"?`APCA Lc ≥ ${K}`:`WCAG ${K}:1`})]})]})})]}),e.jsx("button",{onClick:()=>P(!x),style:{flexShrink:0,padding:"8px",backgroundColor:"#27272a",borderRadius:"8px",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:x?"Exit fullscreen (ESC)":"Enter fullscreen",children:x?e.jsx(ue,{style:{width:"20px",height:"20px",color:"#a1a1aa"}}):e.jsx(me,{style:{width:"20px",height:"20px",color:"#a1a1aa"}})})]}),p&&e.jsxs(W,{style:{backgroundColor:"#18181b",borderRadius:"8px",padding:"16px",border:"1px solid #3f3f46"},children:[e.jsx(a,{size:"3",weight:"bold",mb:"3",children:"Contrast Analysis"}),e.jsxs(i,{gap:"3",wrap:"wrap",mb:"3",children:[e.jsxs(V,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#6366f1"},children:r.total}),e.jsx(a,{size:"1",color:"gray",children:"Total Pairs"})]}),e.jsxs(V,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#22c55e"},children:r.passing}),e.jsxs(a,{size:"1",color:"gray",children:["Passing (",r.passingPercent,"%)"]})]}),e.jsxs(V,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#a855f7"},children:r.apcaHighContrast}),e.jsx(a,{size:"1",color:"gray",children:"APCA Lc ≥ 75"})]}),e.jsxs(V,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#818cf8"},children:r.wcagAAA}),e.jsx(a,{size:"1",color:"gray",children:"WCAG AAA"})]})]}),e.jsx(a,{size:"1",color:"gray",style:{lineHeight:"1.6"},children:"This contrast analysis examines all possible foreground/background combinations within your scale. The statistics show how many color pairs meet accessibility standards."})]}),e.jsx(i,{justify:"center",style:{fontSize:"10px",textTransform:"uppercase",fontFamily:"monospace",letterSpacing:"0.1em",color:"#71717a"},children:"Opacity Steps →"}),e.jsx(W,{ref:y,style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"flex-start",minHeight:"400px"},children:e.jsxs(W,{style:{display:"inline-grid",transform:`scale(${T})`,transformOrigin:"center center",transition:"transform 0.2s ease",gap:"4px",padding:"16px",minWidth:"min-content",gridTemplateColumns:`${k}px repeat(${m.length}, ${k}px)`,gridAutoRows:`${k}px`},children:[e.jsxs(i,{align:"center",justify:"center",style:{fontSize:"10px",opacity:.5,textAlign:"center",lineHeight:"1.2",color:"#71717a"},children:["Source",e.jsx("br",{}),"L↓"]}),m.map(s=>e.jsxs(i,{align:"center",justify:"center",style:{fontSize:"10px",fontFamily:"monospace",color:"#71717a"},children:[s,"%"]},s)),g.map((s,j)=>{const S=Z[j];return S?e.jsxs(te.Fragment,{children:[e.jsx(i,{align:"center",justify:"center",style:{fontSize:"10px",fontFamily:"monospace",fontWeight:"bold",color:"#fafafa"},children:s}),m.map(L=>e.jsx(se,{lightness:s,opacity:L,hue:S.H,chroma:S.C,bgHex:n,bgLuminance:N,blendMode:M,isMatching:v,targetLightness:b,contrastFilterEnabled:U,contrastFilterType:q,contrastFilterThreshold:K,showHeatmap:f,onHover:X,onLeave:_,onClick:w},`${s}-${L}`))]},s):null})]})}),F&&e.jsx(W,{style:{position:"fixed",bottom:"24px",right:"24px",backgroundColor:"#22c55e",color:"white",padding:"12px 16px",borderRadius:"8px",fontWeight:"500",zIndex:100},children:"Copied to clipboard!"})]}),c.visible&&e.jsx("div",{style:{position:"fixed",left:`${c.position.x+10}px`,top:`${c.position.y+10}px`,backgroundColor:"#18181b",border:"1px solid #3f3f46",borderRadius:"8px",padding:"12px",zIndex:1e3,pointerEvents:"none",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.5)"},children:c.content})]})};export{Fe as MatrixView};
