import{R as ee,h as n,j as e,b as H,p as i,I as de,d as a,o as P,_ as pe,$ as he,G as xe,a0 as ge,a8 as ue,a9 as me,f as V}from"./vendor-ui-DtyWSyzN.js";import{b as fe,g as ye,h as be}from"./opacityBlending-xsz6hvED.js";import"./vendor-color-D1ETm4ty.js";import{A as je,u as Ce,g as we}from"./index-BFk0Joi4.js";import{g as Ae,f as Se}from"./documentationExport-BJZGD_NP.js";import"./vendor-react-BnWokTrw.js";function ve(t,o){const l=Math.max(t,o),p=Math.min(t,o);return(l+.05)/(p+.05)}function ze(t,o){const{normBG:l,normTXT:p,revTXT:C,revBG:u,blkThrs:x,blkClmp:w,scaleBoW:I,scaleWoB:v,loConThresh:z,loConOffset:k,deltaYmin:W}=je;o=o>x?o:o+Math.pow(x-o,w),t=t>x?t:t+Math.pow(x-t,w);let r=0,M=0;return Math.abs(o-t)<W?0:(o>t?(r=(Math.pow(o,l)-Math.pow(t,p))*I,M=r<z?0:r-k):(r=(Math.pow(o,u)-Math.pow(t,C))*v,M=r>-z?0:r+k),M*100)}function ke(t,o){const l=ve(t,o),p=ze(t,o);return{apca:Math.abs(p),wcag:l}}const te=ee.memo(({lightness:t,opacity:o,hue:l,chroma:p,bgHex:C,bgLuminance:u,blendMode:x="srgb",isMatching:w=!1,targetLightness:I=50,contrastFilterEnabled:v=!1,contrastFilterType:z="wcag",contrastFilterThreshold:k=4.5,showHeatmap:W=!1,onHover:r,onLeave:M,onClick:T})=>{const m=n.useMemo(()=>fe(t,p,l,o,C,x),[t,p,l,o,C,x]),{wcagContrast:f,apcaContrast:y}=n.useMemo(()=>{const c=ke(m.luminance,u);return{wcagContrast:c.wcag,apcaContrast:c.apca}},[m.luminance,u]),L=w&&Math.abs(m.lightness-I)>3,$=(z==="wcag"?f:y)>=k,B=f>=7,A=f>=4.5,g=y>=90,b=y>=75,N=y>=60,R=(()=>{if(!W)return null;const E=(z==="apca"?y:f)/k;return E>=1.5?"rgba(34, 197, 94, 0.7)":E>=1?"rgba(59, 130, 246, 0.6)":E>=.8?"rgba(251, 191, 36, 0.6)":"rgba(239, 68, 68, 0.7)"})(),h=`oklch(${t}% ${p} ${l} / ${o}%)`,Z=n.useCallback(c=>{requestAnimationFrame(()=>{r({x:c.clientX||0,y:c.clientY||0,content:e.jsxs("div",{style:{fontFamily:"monospace",fontSize:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Source:"}),e.jsxs("span",{style:{color:"#fafafa"},children:["L",t]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Opacity:"}),e.jsxs("span",{style:{color:"#fafafa"},children:[o,"%"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Result L*:"}),e.jsx("span",{style:{color:"#fafafa",fontWeight:"bold"},children:m.lightness.toFixed(1)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Hex:"}),e.jsx("span",{style:{color:"#fafafa",fontFamily:"monospace",fontSize:"10px"},children:m.hex})]}),e.jsxs("div",{style:{marginTop:"8px",borderTop:"1px solid #3f3f46",paddingTop:"8px"},children:[e.jsx("div",{style:{fontSize:"9px",textTransform:"uppercase",letterSpacing:"0.05em",color:"#71717a",marginBottom:"4px"},children:"Contrast"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"WCAG:"}),e.jsxs("span",{style:{color:"#fafafa",fontWeight:"bold"},children:[f.toFixed(2),":1",B&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#22c55e"},children:"AAA"}),!B&&A&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#3b82f6"},children:"AA"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"APCA:"}),e.jsxs("span",{style:{color:"#fafafa",fontWeight:"bold"},children:["Lc ",y.toFixed(0),g&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#facc15"},children:"GOLD"}),!g&&b&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#a1a1aa"},children:"SILVER"}),!g&&!b&&N&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#f97316"},children:"BRONZE"})]})]})]})]})})})},[t,o,m,f,y,B,A,g,b,N,r]),D=n.useCallback(()=>{T(h)},[h,T]);return e.jsx("div",{onClick:D,style:{position:"relative",aspectRatio:"1",backgroundColor:m.hex,borderRadius:"4px",cursor:"pointer",opacity:L?.25:v&&!$?.3:1,transition:"opacity 0.15s, transform 0.1s",border:"1px solid rgba(255, 255, 255, 0.05)"},onMouseEnter:c=>{const d=c.currentTarget;d.style.transform="scale(1.1)",d.style.zIndex="10",Z(c)},onMouseLeave:c=>{const d=c.currentTarget;d.style.transform="scale(1)",d.style.zIndex="1",M()},children:R&&e.jsx("div",{style:{position:"absolute",inset:0,backgroundColor:R,borderRadius:"4px",pointerEvents:"none"}})})});te.displayName="MatrixCell";const He=({scale:t})=>{const{globalSettings:o,selectedBackground:l,getLightnessSteps:p,accessibilitySettings:C}=Ce(),[u,x]=n.useState({visible:!1,content:null,position:{x:0,y:0}}),[w,I]=n.useState(!1),[v,z]=n.useState(60),[k,W]=n.useState(!1),[r,M]=n.useState(!1),[T,m]=n.useState(!1),[f,y]=n.useState(!1),[L,G]=n.useState(1),[$,B]=n.useState(56),A=n.useRef(null),g=p(t),b=o.opacitySteps,N=o.blendMode||"srgb",q=ye(be(l)),R=n.useMemo(()=>g.map(s=>{const j=s/100;return we(j,t.manualChroma,t.hue,t.hueCurve,t.chromaCurve,{contrastMode:t.contrastMode||"standard",calculateContrast:!0,targetBackground:t.targetBackground||"black",targetLc:t.apcaTargetLc,targetWcagRatio:t.wcagTargetRatio,chromaCompensation:t.chromaCompensation??!0})}),[t,g]),h=n.useMemo(()=>Ae(R),[R]),Z=n.useMemo(()=>{if(!C.enabled||!t.contrastThreshold?.enabled)return h;const s={minAPCA:t.contrastThreshold.useApca?t.contrastThreshold.minLc:void 0,minWCAG:t.contrastThreshold.useApca?void 0:t.contrastThreshold.minWcag,useAPCA:t.contrastThreshold.useApca??!0};return Se(h,s)},[h,t.contrastThreshold,C.enabled]),D=n.useCallback(s=>{x({visible:!0,content:s.content,position:{x:s.x,y:s.y}})},[]),c=n.useCallback(()=>{x({visible:!1,content:null,position:{x:0,y:0}})},[]),d=n.useMemo(()=>{const s=h.length,j=Z.length,S=h.filter(O=>O.apca>=75).length,F=h.filter(O=>O.wcagLevel==="AAA").length;return{total:s,passing:j,passingPercent:(j/s*100).toFixed(1),apcaHighContrast:S,wcagAAA:F}},[h,Z]),E=n.useCallback(s=>{navigator.clipboard.writeText(s),W(!0),setTimeout(()=>W(!1),2e3)},[]),se=n.useCallback(()=>{G(s=>Math.max(s-.25,.5))},[]),ne=n.useCallback(()=>{G(s=>Math.min(s+.25,2))},[]),oe=n.useCallback(()=>{G(1)},[]),K=C.enabled&&(t.contrastThreshold?.enabled||!1),X=t.contrastThreshold?.useApca?"apca":"wcag",_=X==="apca"?t.contrastThreshold?.minLc||60:t.contrastThreshold?.minWcag||4.5;return n.useEffect(()=>{const s=()=>{if(!A.current)return;const S=A.current,F=S.clientWidth,O=S.clientHeight,U=32,J=4,Q=b.length,Y=g.length,ae=F-U-J*(Q+2),re=O-U-60-J*(Y+1),ie=Math.floor(ae/(Q+1)),le=Math.floor(re/Y),ce=Math.max(40,Math.min(ie,le,120));B(ce)};s();const j=new ResizeObserver(s);return A.current&&j.observe(A.current),()=>{j.disconnect()}},[b.length,g.length,r,T]),e.jsxs(H,{style:{position:"relative",width:"100%",display:"flex",flexDirection:"column",flex:1,minHeight:0,...r?{position:"fixed",inset:0,zIndex:50,backgroundColor:"#09090b"}:{}},children:[e.jsxs(i,{direction:"column",gap:"4",p:"4",style:{flex:1,minHeight:0,maxWidth:"100%",overflowY:"auto",paddingBottom:"80px"},children:[e.jsxs(i,{align:"center",justify:"between",gap:"3",style:{backgroundColor:"#18181b",borderRadius:"8px",padding:"10px 12px",border:"1px solid #3f3f46",flexWrap:"wrap"},children:[e.jsxs(i,{align:"center",gap:"2",style:{flex:"1",minWidth:"200px"},children:[e.jsx(de,{style:{width:"16px",height:"16px",color:"#6366f1",flexShrink:0}}),e.jsxs(a,{size:"1",color:"gray",children:[e.jsx(a,{as:"span",weight:"medium",style:{color:"#d4d4d8"},children:t.name})," ","at opacity levels on ",l]})]}),e.jsxs(i,{align:"center",gap:"3",style:{flexWrap:"wrap"},children:[e.jsxs(i,{align:"center",gap:"2",children:[e.jsx("input",{type:"checkbox",id:"match-mode",checked:w,onChange:s=>I(s.target.checked),style:{width:"16px",height:"16px",borderRadius:"4px",cursor:"pointer"}}),e.jsx(a,{as:"label",htmlFor:"match-mode",size:"1",weight:"medium",style:{cursor:"pointer",color:"#d4d4d8"},children:"Match"})]}),w&&e.jsxs(i,{align:"center",gap:"2",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:v,onChange:s=>z(Number(s.target.value)),style:{width:"96px"}}),e.jsxs(a,{size:"1",weight:"medium",style:{fontFamily:"monospace",width:"32px",color:"#d4d4d8"},children:["L",v]})]}),e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(a,{size:"1",weight:"medium",style:{color:"#a1a1aa"},children:"Zoom:"}),e.jsx(P,{size:"1",variant:"soft",onClick:se,disabled:L<=.5,children:"-"}),e.jsxs(a,{size:"1",weight:"bold",style:{fontFamily:"monospace",minWidth:"48px",textAlign:"center",color:"#d4d4d8"},children:[Math.round(L*100),"%"]}),e.jsx(P,{size:"1",variant:"soft",onClick:ne,disabled:L>=2,children:"+"}),e.jsx(P,{size:"1",variant:"outline",onClick:oe,disabled:L===1,children:"Reset"})]})]}),e.jsxs(pe,{children:[e.jsx(he,{children:e.jsxs(P,{size:"2",variant:"outline",children:[e.jsx(xe,{width:"16",height:"16"}),"Advanced"]})}),e.jsx(ge,{style:{width:"280px"},children:e.jsxs(i,{direction:"column",gap:"3",children:[e.jsx(a,{size:"2",weight:"bold",children:"Advanced Options"}),e.jsxs(P,{size:"2",variant:"soft",onClick:()=>m(!T),style:{width:"100%"},children:[T?"Hide":"Show"," Contrast Insights"]}),e.jsxs(i,{align:"center",gap:"2",children:[e.jsx("input",{type:"checkbox",id:"heatmap-mode",checked:f,onChange:s=>y(s.target.checked),style:{width:"16px",height:"16px",borderRadius:"4px",cursor:"pointer"}}),e.jsx(a,{as:"label",htmlFor:"heatmap-mode",size:"2",weight:"medium",style:{cursor:"pointer",color:"#d4d4d8"},children:"Heatmap Mode"})]}),K&&e.jsxs(H,{children:[e.jsx(a,{size:"1",weight:"medium",mb:"1",style:{color:"#a1a1aa"},children:"Active Filter"}),e.jsx(a,{size:"2",style:{color:"#d4d4d8",fontFamily:"monospace"},children:X==="apca"?`APCA Lc ≥ ${_}`:`WCAG ${_}:1`})]})]})})]}),e.jsx("button",{onClick:()=>M(!r),style:{flexShrink:0,padding:"8px",backgroundColor:"#27272a",borderRadius:"8px",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:r?"Exit fullscreen (ESC)":"Enter fullscreen",children:r?e.jsx(ue,{style:{width:"20px",height:"20px",color:"#a1a1aa"}}):e.jsx(me,{style:{width:"20px",height:"20px",color:"#a1a1aa"}})})]}),T&&e.jsxs(H,{style:{backgroundColor:"#18181b",borderRadius:"8px",padding:"16px",border:"1px solid #3f3f46"},children:[e.jsx(a,{size:"3",weight:"bold",mb:"3",children:"Contrast Analysis"}),e.jsxs(i,{gap:"3",wrap:"wrap",mb:"3",children:[e.jsxs(V,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#6366f1"},children:d.total}),e.jsx(a,{size:"1",color:"gray",children:"Total Pairs"})]}),e.jsxs(V,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#22c55e"},children:d.passing}),e.jsxs(a,{size:"1",color:"gray",children:["Passing (",d.passingPercent,"%)"]})]}),e.jsxs(V,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#a855f7"},children:d.apcaHighContrast}),e.jsx(a,{size:"1",color:"gray",children:"APCA Lc ≥ 75"})]}),e.jsxs(V,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#818cf8"},children:d.wcagAAA}),e.jsx(a,{size:"1",color:"gray",children:"WCAG AAA"})]})]}),e.jsx(a,{size:"1",color:"gray",style:{lineHeight:"1.6"},children:"This contrast analysis examines all possible foreground/background combinations within your scale. The statistics show how many color pairs meet accessibility standards."})]}),e.jsx(i,{justify:"center",style:{fontSize:"10px",textTransform:"uppercase",fontFamily:"monospace",letterSpacing:"0.1em",color:"#71717a"},children:"Opacity Steps →"}),e.jsx(H,{ref:A,style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"flex-start",minHeight:"400px"},children:e.jsxs(H,{style:{display:"inline-grid",transform:`scale(${L})`,transformOrigin:"center center",transition:"transform 0.2s ease",gap:"4px",padding:"16px",minWidth:"min-content",gridTemplateColumns:`${$}px repeat(${b.length}, ${$}px)`,gridAutoRows:`${$}px`},children:[e.jsxs(i,{align:"center",justify:"center",style:{fontSize:"10px",opacity:.5,textAlign:"center",lineHeight:"1.2",color:"#71717a"},children:["Source",e.jsx("br",{}),"L↓"]}),b.map(s=>e.jsxs(i,{align:"center",justify:"center",style:{fontSize:"10px",fontFamily:"monospace",color:"#71717a"},children:[s,"%"]},s)),g.map((s,j)=>{const S=R[j];return S?e.jsxs(ee.Fragment,{children:[e.jsx(i,{align:"center",justify:"center",style:{fontSize:"10px",fontFamily:"monospace",fontWeight:"bold",color:"#fafafa"},children:s}),b.map(F=>e.jsx(te,{lightness:s,opacity:F,hue:S.H,chroma:S.C,bgHex:l,bgLuminance:q,blendMode:N,isMatching:w,targetLightness:v,contrastFilterEnabled:K,contrastFilterType:X,contrastFilterThreshold:_,showHeatmap:f,onHover:D,onLeave:c,onClick:E},`${s}-${F}`))]},s):null})]})}),k&&e.jsx(H,{style:{position:"fixed",bottom:"24px",right:"24px",backgroundColor:"#22c55e",color:"white",padding:"12px 16px",borderRadius:"8px",fontWeight:"500",zIndex:100},children:"Copied to clipboard!"})]}),u.visible&&e.jsx("div",{style:{position:"fixed",left:`${u.position.x+10}px`,top:`${u.position.y+10}px`,backgroundColor:"#18181b",border:"1px solid #3f3f46",borderRadius:"8px",padding:"12px",zIndex:1e3,pointerEvents:"none",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.5)"},children:u.content})]})};export{He as MatrixView};
