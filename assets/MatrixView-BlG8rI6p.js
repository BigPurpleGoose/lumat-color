import{R as ee,h as n,j as e,b as W,e as ce,p as i,I as de,d as a,o as O,$ as pe,a0 as he,G as xe,a1 as ge,a9 as ue,aa as me,f as Z}from"./vendor-ui-PEyQLrjK.js";import{b as fe,g as ye,h as je}from"./opacityBlending-D_EI2fGY.js";import"./vendor-color-D1ETm4ty.js";import{A as be,u as Ce,g as we}from"./index-BeXAM3DK.js";import{g as Ae,f as Se}from"./documentationExport-CKhrJqp3.js";import"./vendor-react-D6La9ApI.js";function ve(t,o){const l=Math.max(t,o),d=Math.min(t,o);return(l+.05)/(d+.05)}function ze(t,o){const{normBG:l,normTXT:d,revTXT:f,revBG:z,blkThrs:p,blkClmp:T,scaleBoW:k,scaleWoB:R,loConThresh:M,loConOffset:C,deltaYmin:y}=be;o=o>p?o:o+Math.pow(p-o,T),t=t>p?t:t+Math.pow(p-t,T);let h=0,x=0;return Math.abs(o-t)<y?0:(o>t?(h=(Math.pow(o,l)-Math.pow(t,d))*k,x=h<M?0:h-C):(h=(Math.pow(o,z)-Math.pow(t,f))*R,x=h>-M?0:h+C),x*100)}function ke(t,o){const l=ve(t,o),d=ze(t,o);return{apca:Math.abs(d),wcag:l}}const te=ee.memo(({lightness:t,opacity:o,hue:l,chroma:d,bgHex:f,bgLuminance:z,blendMode:p="srgb",isMatching:T=!1,targetLightness:k=50,contrastFilterEnabled:R=!1,contrastFilterType:M="wcag",contrastFilterThreshold:C=4.5,showHeatmap:y=!1,onHover:h,onLeave:x,onClick:E})=>{const g=n.useMemo(()=>fe(t,d,l,o,f,p),[t,d,l,o,f,p]),{wcagContrast:w,apcaContrast:c}=n.useMemo(()=>{const r=ke(g.luminance,z);return{wcagContrast:r.wcag,apcaContrast:r.apca}},[g.luminance,z]),F=T&&Math.abs(g.lightness-k)>3,V=(M==="wcag"?w:c)>=C,j=w>=7,A=w>=4.5,u=c>=90,H=c>=75,G=c>=60,m=(()=>{if(!y)return null;const $=(M==="apca"?c:w)/C;return $>=1.5?"rgba(34, 197, 94, 0.7)":$>=1?"rgba(59, 130, 246, 0.6)":$>=.8?"rgba(251, 191, 36, 0.6)":"rgba(239, 68, 68, 0.7)"})(),I=`oklch(${t}% ${d} ${l} / ${o}%)`,X=n.useCallback(r=>{requestAnimationFrame(()=>{h({x:r.clientX||0,y:r.clientY||0,content:e.jsxs("div",{style:{fontFamily:"monospace",fontSize:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Source:"}),e.jsxs("span",{style:{color:"#fafafa"},children:["L",t]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Opacity:"}),e.jsxs("span",{style:{color:"#fafafa"},children:[o,"%"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Result L*:"}),e.jsx("span",{style:{color:"#fafafa",fontWeight:"bold"},children:g.lightness.toFixed(1)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"Hex:"}),e.jsx("span",{style:{color:"#fafafa",fontFamily:"monospace",fontSize:"10px"},children:g.hex})]}),e.jsxs("div",{style:{marginTop:"8px",borderTop:"1px solid #3f3f46",paddingTop:"8px"},children:[e.jsx("div",{style:{fontSize:"9px",textTransform:"uppercase",letterSpacing:"0.05em",color:"#71717a",marginBottom:"4px"},children:"Contrast"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"WCAG:"}),e.jsxs("span",{style:{color:"#fafafa",fontWeight:"bold"},children:[w.toFixed(2),":1",j&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#22c55e"},children:"AAA"}),!j&&A&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#3b82f6"},children:"AA"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"12px"},children:[e.jsx("span",{style:{color:"#a1a1aa"},children:"APCA:"}),e.jsxs("span",{style:{color:"#fafafa",fontWeight:"bold"},children:["Lc ",c.toFixed(0),u&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#facc15"},children:"GOLD"}),!u&&H&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#a1a1aa"},children:"SILVER"}),!u&&!H&&G&&e.jsx("span",{style:{marginLeft:"4px",fontSize:"8px",color:"#f97316"},children:"BRONZE"})]})]})]})]})})})},[t,o,g,w,c,j,A,u,H,G,h]),D=n.useCallback(()=>{E(I)},[I,E]);return e.jsx("div",{onClick:D,style:{position:"relative",aspectRatio:"1",backgroundColor:g.hex,borderRadius:"4px",cursor:"pointer",opacity:F?.25:R&&!V?.3:1,transition:"opacity 0.15s, transform 0.1s",border:"1px solid rgba(255, 255, 255, 0.05)"},onMouseEnter:r=>{const S=r.currentTarget;S.style.transform="scale(1.1)",S.style.zIndex="10",X(r)},onMouseLeave:r=>{const S=r.currentTarget;S.style.transform="scale(1)",S.style.zIndex="1",x()},children:m&&e.jsx("div",{style:{position:"absolute",inset:0,backgroundColor:m,borderRadius:"4px",pointerEvents:"none"}})})});te.displayName="MatrixCell";const He=({scale:t})=>{const{globalSettings:o,selectedBackground:l,getLightnessSteps:d}=Ce(),[f,z]=n.useState({visible:!1,content:null,position:{x:0,y:0}}),[p,T]=n.useState(!1),[k,R]=n.useState(60),[M,C]=n.useState(!1),[y,h]=n.useState(!1),[x,E]=n.useState(!1),[g,w]=n.useState(!1),[c,F]=n.useState(1),[P,V]=n.useState(56),j=n.useRef(null),A=d(t),u=o.opacitySteps,H=o.blendMode||"srgb",G=ye(je(l)),N=n.useMemo(()=>A.map(s=>{const b=s/100;return we(b,t.manualChroma,t.hue,t.hueCurve,t.chromaCurve,{contrastMode:t.contrastMode||"standard",calculateContrast:!0,targetBackground:t.targetBackground||"black",targetLc:t.apcaTargetLc,targetWcagRatio:t.wcagTargetRatio,chromaCompensation:t.chromaCompensation??!0})}),[t,A]),m=n.useMemo(()=>Ae(N),[N]),I=n.useMemo(()=>{if(!t.contrastThreshold?.enabled)return m;const s={minAPCA:t.contrastThreshold.useApca?t.contrastThreshold.minLc:void 0,minWCAG:t.contrastThreshold.useApca?void 0:t.contrastThreshold.minWcag,useAPCA:t.contrastThreshold.useApca??!0};return Se(m,s)},[m,t.contrastThreshold]),X=n.useCallback(s=>{z({visible:!0,content:s.content,position:{x:s.x,y:s.y}})},[]),D=n.useCallback(()=>{z({visible:!1,content:null,position:{x:0,y:0}})},[]),r=n.useMemo(()=>{const s=m.length,b=I.length,v=m.filter(B=>B.apca>=75).length,L=m.filter(B=>B.wcagLevel==="AAA").length;return{total:s,passing:b,passingPercent:(b/s*100).toFixed(1),apcaHighContrast:v,wcagAAA:L}},[m,I]),S=n.useCallback(s=>{navigator.clipboard.writeText(s),C(!0),setTimeout(()=>C(!1),2e3)},[]),$=n.useCallback(()=>{F(s=>Math.max(s-.25,.5))},[]),se=n.useCallback(()=>{F(s=>Math.min(s+.25,2))},[]),ne=n.useCallback(()=>{F(1)},[]),K=t.contrastThreshold?.enabled||!1,_=t.contrastThreshold?.useApca?"apca":"wcag",q=_==="apca"?t.contrastThreshold?.minLc||60:t.contrastThreshold?.minWcag||4.5;return n.useEffect(()=>{const s=()=>{if(!j.current)return;const v=j.current,L=v.clientWidth,B=v.clientHeight,U=32,J=4,Q=u.length,Y=A.length,oe=L-U-J*(Q+2),ae=B-U-60-J*(Y+1),re=Math.floor(oe/(Q+1)),ie=Math.floor(ae/Y),le=Math.max(40,Math.min(re,ie,120));V(le)};s();const b=new ResizeObserver(s);return j.current&&b.observe(j.current),()=>{b.disconnect()}},[u.length,A.length,y,x]),e.jsxs(W,{style:{position:"relative",width:"100%",display:"flex",flexDirection:"column",flex:1,minHeight:0,...y?{position:"fixed",inset:0,zIndex:50,backgroundColor:"#09090b"}:{}},children:[e.jsx(ce,{style:{flex:1},children:e.jsxs(i,{direction:"column",gap:"4",p:"4",style:{maxWidth:"100%",paddingBottom:"80px"},children:[e.jsxs(i,{align:"center",justify:"between",gap:"3",style:{backgroundColor:"#18181b",borderRadius:"8px",padding:"10px 12px",border:"1px solid #3f3f46",flexWrap:"wrap"},children:[e.jsxs(i,{align:"center",gap:"2",style:{flex:"1",minWidth:"200px"},children:[e.jsx(de,{style:{width:"16px",height:"16px",color:"#6366f1",flexShrink:0}}),e.jsxs(a,{size:"1",color:"gray",children:[e.jsx(a,{as:"span",weight:"medium",style:{color:"#d4d4d8"},children:t.name})," ","at opacity levels on ",l]})]}),e.jsxs(i,{align:"center",gap:"3",style:{flexWrap:"wrap"},children:[e.jsxs(i,{align:"center",gap:"2",children:[e.jsx("input",{type:"checkbox",id:"match-mode",checked:p,onChange:s=>T(s.target.checked),style:{width:"16px",height:"16px",borderRadius:"4px",cursor:"pointer"}}),e.jsx(a,{as:"label",htmlFor:"match-mode",size:"1",weight:"medium",style:{cursor:"pointer",color:"#d4d4d8"},children:"Match"})]}),p&&e.jsxs(i,{align:"center",gap:"2",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:k,onChange:s=>R(Number(s.target.value)),style:{width:"96px"}}),e.jsxs(a,{size:"1",weight:"medium",style:{fontFamily:"monospace",width:"32px",color:"#d4d4d8"},children:["L",k]})]}),e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(a,{size:"1",weight:"medium",style:{color:"#a1a1aa"},children:"Zoom:"}),e.jsx(O,{size:"1",variant:"soft",onClick:$,disabled:c<=.5,children:"-"}),e.jsxs(a,{size:"1",weight:"bold",style:{fontFamily:"monospace",minWidth:"48px",textAlign:"center",color:"#d4d4d8"},children:[Math.round(c*100),"%"]}),e.jsx(O,{size:"1",variant:"soft",onClick:se,disabled:c>=2,children:"+"}),e.jsx(O,{size:"1",variant:"outline",onClick:ne,disabled:c===1,children:"Reset"})]})]}),e.jsxs(pe,{children:[e.jsx(he,{children:e.jsxs(O,{size:"2",variant:"outline",children:[e.jsx(xe,{width:"16",height:"16"}),"Advanced"]})}),e.jsx(ge,{style:{width:"280px"},children:e.jsxs(i,{direction:"column",gap:"3",children:[e.jsx(a,{size:"2",weight:"bold",children:"Advanced Options"}),e.jsxs(O,{size:"2",variant:"soft",onClick:()=>E(!x),style:{width:"100%"},children:[x?"Hide":"Show"," Contrast Insights"]}),e.jsxs(i,{align:"center",gap:"2",children:[e.jsx("input",{type:"checkbox",id:"heatmap-mode",checked:g,onChange:s=>w(s.target.checked),style:{width:"16px",height:"16px",borderRadius:"4px",cursor:"pointer"}}),e.jsx(a,{as:"label",htmlFor:"heatmap-mode",size:"2",weight:"medium",style:{cursor:"pointer",color:"#d4d4d8"},children:"Heatmap Mode"})]}),K&&e.jsxs(W,{children:[e.jsx(a,{size:"1",weight:"medium",mb:"1",style:{color:"#a1a1aa"},children:"Active Filter"}),e.jsx(a,{size:"2",style:{color:"#d4d4d8",fontFamily:"monospace"},children:_==="apca"?`APCA Lc ≥ ${q}`:`WCAG ${q}:1`})]})]})})]}),e.jsx("button",{onClick:()=>h(!y),style:{flexShrink:0,padding:"8px",backgroundColor:"#27272a",borderRadius:"8px",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:y?"Exit fullscreen (ESC)":"Enter fullscreen",children:y?e.jsx(ue,{style:{width:"20px",height:"20px",color:"#a1a1aa"}}):e.jsx(me,{style:{width:"20px",height:"20px",color:"#a1a1aa"}})})]}),x&&e.jsxs(W,{style:{backgroundColor:"#18181b",borderRadius:"8px",padding:"16px",border:"1px solid #3f3f46"},children:[e.jsx(a,{size:"3",weight:"bold",mb:"3",children:"Contrast Analysis"}),e.jsxs(i,{gap:"3",wrap:"wrap",mb:"3",children:[e.jsxs(Z,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#6366f1"},children:r.total}),e.jsx(a,{size:"1",color:"gray",children:"Total Pairs"})]}),e.jsxs(Z,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#22c55e"},children:r.passing}),e.jsxs(a,{size:"1",color:"gray",children:["Passing (",r.passingPercent,"%)"]})]}),e.jsxs(Z,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#a855f7"},children:r.apcaHighContrast}),e.jsx(a,{size:"1",color:"gray",children:"APCA Lc ≥ 75"})]}),e.jsxs(Z,{style:{flex:"1",minWidth:"150px",backgroundColor:"#27272a",padding:"12px"},children:[e.jsx(a,{size:"6",weight:"bold",style:{color:"#818cf8"},children:r.wcagAAA}),e.jsx(a,{size:"1",color:"gray",children:"WCAG AAA"})]})]}),e.jsx(a,{size:"1",color:"gray",style:{lineHeight:"1.6"},children:"This contrast analysis examines all possible foreground/background combinations within your scale. The statistics show how many color pairs meet accessibility standards."})]}),e.jsx(i,{justify:"center",style:{fontSize:"10px",textTransform:"uppercase",fontFamily:"monospace",letterSpacing:"0.1em",color:"#71717a"},children:"Opacity Steps →"}),e.jsx(W,{ref:j,style:{width:"100%",flex:1,overflowX:"auto",overflowY:"auto",display:"flex",justifyContent:"center",alignItems:"center",WebkitOverflowScrolling:"touch"},children:e.jsxs(W,{style:{display:"inline-grid",transform:`scale(${c})`,transformOrigin:"center center",transition:"transform 0.2s ease",gap:"4px",padding:"16px",minWidth:"min-content",gridTemplateColumns:`${P}px repeat(${u.length}, ${P}px)`,gridAutoRows:`${P}px`},children:[e.jsxs(i,{align:"center",justify:"center",style:{fontSize:"10px",opacity:.5,textAlign:"center",lineHeight:"1.2",color:"#71717a"},children:["Source",e.jsx("br",{}),"L↓"]}),u.map(s=>e.jsxs(i,{align:"center",justify:"center",style:{fontSize:"10px",fontFamily:"monospace",color:"#71717a"},children:[s,"%"]},s)),A.map((s,b)=>{const v=N[b];return v?e.jsxs(ee.Fragment,{children:[e.jsx(i,{align:"center",justify:"center",style:{fontSize:"10px",fontFamily:"monospace",fontWeight:"bold",color:"#fafafa"},children:s}),u.map(L=>e.jsx(te,{lightness:s,opacity:L,hue:v.H,chroma:v.C,bgHex:l,bgLuminance:G,blendMode:H,isMatching:p,targetLightness:k,contrastFilterEnabled:K,contrastFilterType:_,contrastFilterThreshold:q,showHeatmap:g,onHover:X,onLeave:D,onClick:S},`${s}-${L}`))]},s):null})]})}),M&&e.jsx(W,{style:{position:"fixed",bottom:"24px",right:"24px",backgroundColor:"#22c55e",color:"white",padding:"12px 16px",borderRadius:"8px",fontWeight:"500",zIndex:100},children:"Copied to clipboard!"})]})}),f.visible&&e.jsx("div",{style:{position:"fixed",left:`${f.position.x+10}px`,top:`${f.position.y+10}px`,backgroundColor:"#18181b",border:"1px solid #3f3f46",borderRadius:"8px",padding:"12px",zIndex:1e3,pointerEvents:"none",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.5)"},children:f.content})]})};export{He as MatrixView};
